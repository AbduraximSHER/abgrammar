import{initializeApp as p}from"https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";import{getAuth as g,GoogleAuthProvider as h,onAuthStateChanged as y,signInWithEmailAndPassword as w,createUserWithEmailAndPassword as b,updateProfile as A,signInWithPopup as P,signOut as I}from"https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js";import{getFirestore as S,doc as c,getDoc as l,setDoc as v,serverTimestamp as C}from"https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const u of s.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function a(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=a(r);fetch(r.href,s)}})();const O={apiKey:"AIzaSyAOMkOFajSbtPXZQ5ojpd1XuCZWxqrmeCY",authDomain:"abgrammar-7bf41.firebaseapp.com",projectId:"abgrammar-7bf41",storageBucket:"abgrammar-7bf41.firebasestorage.app",messagingSenderId:"181822910792",appId:"1:181822910792:web:9fa751eda143979ea4437d",measurementId:"G-NWHR4L8HLT"},d=p(O),o=g(d),f=S(d),L=new h;function i(e){switch(console.error("Auth Error:",e),e.code){case"auth/invalid-credential":return"Login failed: Invalid email or password. Please try again.";case"auth/unauthorized-domain":return"Login failed: The domain is not authorized. Please add this domain in Firebase Console -> Authentication -> Settings -> Authorized Domains.";case"auth/operation-not-allowed":case"auth/operation-not-allowed-in-this-operation":return"Login failed: This sign-in method is not enabled. Enable it in Firebase Console -> Authentication -> Sign-in method.";case"auth/configuration-not-found":return"Login failed: Firebase Authentication is not configured correctly. Check your Firebase project settings.";case"auth/invalid-api-key":case"auth/api-key-not-valid.-please-pass-a-valid-api-key.":return"Login failed: Invalid Firebase API key. Update the Firebase config for this site.";case"auth/network-request-failed":return"Network error. Check your internet connection and try again.";case"auth/user-not-found":case"auth/invalid-email":return"No user found with this email.";case"auth/wrong-password":return"Incorrect password.";case"auth/email-already-in-use":return"This email is already registered.";case"auth/popup-closed-by-user":return"Sign-in cancelled.";case"auth/too-many-requests":return"Too many attempts. Please try again later.";default:return e.message||"Authentication failed. Please try again."}}async function m(e,t){const a=c(f,"users",e.uid);return(await l(a)).exists()||await v(a,{uid:e.uid,email:e.email,displayName:e.displayName||e.email.split("@")[0],provider:t,createdAt:C(),hasPlacement:!1,level:null,placementScore:null,placementTakenAt:null}),a}async function D(e){const t=c(f,"users",e),a=await l(t);return a.exists()?a.data():null}async function T(e,t,a){try{const r=(await b(o,e,t)).user;return await A(r,{displayName:a}),await m(r,"password"),{success:!0,user:r}}catch(n){return{success:!1,error:i(n)}}}async function z(e,t){try{return{success:!0,user:(await w(o,e,t)).user}}catch(a){return{success:!1,error:i(a)}}}async function x(){try{const t=(await P(o,L)).user;return await m(t,"google"),{success:!0,user:t}}catch(e){return{success:!1,error:i(e)}}}async function U(){try{return await I(o),{success:!0}}catch(e){return{success:!1,error:i(e)}}}function j(e){return y(o,e)}export{o as a,T as b,x as c,f as d,D as g,U as l,j as o,z as s};
